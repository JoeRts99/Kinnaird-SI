
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Premier League Club Financials</title>
  <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
  <style>
    body {
      background-color: #11242B;
      color: white;
      font-family: 'aglet-sans, sans-serif';
      padding: 20px;
      margin: 0;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .controls {
      text-align: center;
      margin-bottom: 20px;
    }
    select {
      font-size: 1.1rem;
      padding: 5px;
      margin-right: 20px;
    }
  </style>
</head>
<body>
  <h1>Premier League Club Financials</h1>
  <div class="controls">
    <label for="yearSelect">Select Year:</label>
    <select id="yearSelect"></select>
    <label for="metricSelect">Select Metric:</label>
    <select id="metricSelect">
      <option value="revenue">Revenue</option>
      <option value="wages">Wages</option>
      <option value="amortisation">Amortisation</option>
    </select>
  </div>
  <div id="barChart"></div>
  
  <script>
    // Embedded data from SQL
    var data = [{"year":2018,"team":"Chelsea","revenue":443449000.0,"wages":216009000.0,"amortisation":123692000.0,"position_finished":"5th","league":"Premier League","revenue_m":443.449,"wages_m":216.009,"amortisation_m":123.692},{"year":2022,"team":"West Ham","revenue":252720000.0,"wages":118709000.0,"amortisation":48825000.0,"position_finished":"7th","league":"Premier League","revenue_m":252.72,"wages_m":118.709,"amortisation_m":48.825},{"year":2017,"team":"Southampton","revenue":182252000.0,"wages":98859000.0,"amortisation":27394000.0,"position_finished":"8th","league":"Premier League","revenue_m":182.252,"wages_m":98.859,"amortisation_m":27.394},{"year":2019,"team":"Liverpool","revenue":533022000.0,"wages":276197000.0,"amortisation":111777000.0,"position_finished":"2nd","league":"Premier League","revenue_m":533.022,"wages_m":276.197,"amortisation_m":111.777},{"year":2018,"team":"Liverpool","revenue":455089000.0,"wages":232672000.0,"amortisation":77057000.0,"position_finished":"4th","league":"Premier League","revenue_m":455.089,"wages_m":232.672,"amortisation_m":77.057},{"year":2019,"team":"Fulham","revenue":137748000.0,"wages":81031000.0,"amortisation":42808000.0,"position_finished":"19th","league":"Premier League","revenue_m":137.748,"wages_m":81.031,"amortisation_m":42.808},{"year":2016,"team":"Southampton","revenue":124262000.0,"wages":74284000.0,"amortisation":31031000.0,"position_finished":"6th","league":"Premier League","revenue_m":124.262,"wages_m":74.284,"amortisation_m":31.031},{"year":2023,"team":"West Ham","revenue":236656000.0,"wages":118823000.0,"amortisation":65306000.0,"position_finished":"14th","league":"Premier League","revenue_m":236.656,"wages_m":118.823,"amortisation_m":65.306},{"year":2019,"team":"Chelsea","revenue":446741000.0,"wages":251135000.0,"amortisation":167637000.0,"position_finished":"3rd","league":"Premier League","revenue_m":446.741,"wages_m":251.135,"amortisation_m":167.637},{"year":2021,"team":"West Ham","revenue":192728000.0,"wages":112892000.0,"amortisation":57755000.0,"position_finished":"6th","league":"Premier League","revenue_m":192.728,"wages_m":112.892,"amortisation_m":57.755},{"year":2017,"team":"Bournemouth","revenue":136456000.0,"wages":62512000.0,"amortisation":19520000.0,"position_finished":"9th","league":"Premier League","revenue_m":136.456,"wages_m":62.512,"amortisation_m":19.52},{"year":2016,"team":"Bournemouth","revenue":87875000.0,"wages":51829000.0,"amortisation":13086000.0,"position_finished":"16th","league":"Premier League","revenue_m":87.875,"wages_m":51.829,"amortisation_m":13.086},{"year":2015,"team":"Southampton","revenue":113735437.0,"wages":70843127.0,"amortisation":29578529.0,"position_finished":"7th","league":"Premier League","revenue_m":113.735437,"wages_m":70.843127,"amortisation_m":29.578529},{"year":2020,"team":"West Ham","revenue":139500000.0,"wages":114791000.0,"amortisation":59856000.0,"position_finished":"16th","league":"Premier League","revenue_m":139.5,"wages_m":114.791,"amortisation_m":59.856},{"year":2022,"team":"Chelsea","revenue":481278000.0,"wages":297569000.0,"amortisation":160375000.0,"position_finished":"3rd","league":"Premier League","revenue_m":481.278,"wages_m":297.569,"amortisation_m":160.375},{"year":2018,"team":"West Ham","revenue":175346000.0,"wages":93768000.0,"amortisation":41021000.0,"position_finished":"13th","league":"Premier League","revenue_m":175.346,"wages_m":93.768,"amortisation_m":41.021},{"year":2022,"team":"Brentford","revenue":140913000.0,"wages":68152000.0,"amortisation":22851000.0,"position_finished":"13th","league":"Premier League","revenue_m":140.913,"wages_m":68.152,"amortisation_m":22.851},{"year":2023,"team":"Liverpool","revenue":593836000.0,"wages":329980000.0,"amortisation":107546000.0,"position_finished":"5th","league":"Premier League","revenue_m":593.836,"wages_m":329.98,"amortisation_m":107.546},{"year":2022,"team":"Liverpool","revenue":594271000.0,"wages":366092000.0,"amortisation":102714000.0,"position_finished":"2nd","league":"Premier League","revenue_m":594.271,"wages_m":366.092,"amortisation_m":102.714},{"year":2023,"team":"Brentford","revenue":166508000.0,"wages":98800000.0,"amortisation":30903000.0,"position_finished":"9th","league":"Premier League","revenue_m":166.508,"wages_m":98.8,"amortisation_m":30.903},{"year":2023,"team":"Fulham","revenue":182325000.0,"wages":121511000.0,"amortisation":45617000.0,"position_finished":"10th","league":"Premier League","revenue_m":182.325,"wages_m":121.511,"amortisation_m":45.617},{"year":2015,"team":"Manchester United","revenue":182623000.0,"wages":142299000.0,"amortisation":99534000.0,"position_finished":"4th","league":"Premier League","revenue_m":182.623,"wages_m":142.299,"amortisation_m":99.534},{"year":2019,"team":"West Ham","revenue":190695000.0,"wages":118880000.0,"amortisation":57371000.0,"position_finished":"10th","league":"Premier League","revenue_m":190.695,"wages_m":118.88,"amortisation_m":57.371},{"year":2015,"team":"Everton","revenue":125572000.0,"wages":77515000.0,"amortisation":19534000.0,"position_finished":"11th","league":"Premier League","revenue_m":125.572,"wages_m":77.515,"amortisation_m":19.534},{"year":2023,"team":"Chelsea","revenue":512467000.0,"wages":403962000.0,"amortisation":203250000.0,"position_finished":"12th","league":"Premier League","revenue_m":512.467,"wages_m":403.962,"amortisation_m":203.25},{"year":2021,"team":"Chelsea","revenue":434863000.0,"wages":332905000.0,"amortisation":163864000.0,"position_finished":"4th","league":"Premier League","revenue_m":434.863,"wages_m":332.905,"amortisation_m":163.864},{"year":2017,"team":"Everton","revenue":171330000.0,"wages":92144000.0,"amortisation":37298000.0,"position_finished":"7th","league":"Premier League","revenue_m":171.33,"wages_m":92.144,"amortisation_m":37.298},{"year":2017,"team":"Manchester United","revenue":289038000.0,"wages":187861000.0,"amortisation":123696000.0,"position_finished":"6th","league":"Premier League","revenue_m":289.038,"wages_m":187.861,"amortisation_m":123.696},{"year":2021,"team":"Fulham","revenue":116111000.0,"wages":99927000.0,"amortisation":56452000.0,"position_finished":"18th","league":"Premier League","revenue_m":116.111,"wages_m":99.927,"amortisation_m":56.452},{"year":2020,"team":"Liverpool","revenue":489860000.0,"wages":289341000.0,"amortisation":106034000.0,"position_finished":"1st","league":"Premier League","revenue_m":489.86,"wages_m":289.341,"amortisation_m":106.034},{"year":2021,"team":"Liverpool","revenue":487365000.0,"wages":277808000.0,"amortisation":107811000.0,"position_finished":"3rd","league":"Premier League","revenue_m":487.365,"wages_m":277.808,"amortisation_m":107.811},{"year":2016,"team":"Manchester United","revenue":230271000.0,"wages":164313000.0,"amortisation":87853000.0,"position_finished":"5th","league":"Premier League","revenue_m":230.271,"wages_m":164.313,"amortisation_m":87.853},{"year":2016,"team":"Everton","revenue":121541000.0,"wages":73914000.0,"amortisation":22398000.0,"position_finished":"11th","league":"Premier League","revenue_m":121.541,"wages_m":73.914,"amortisation_m":22.398},{"year":2020,"team":"Chelsea","revenue":407402000.0,"wages":249328000.0,"amortisation":127302000.0,"position_finished":"4th","league":"Premier League","revenue_m":407.402,"wages_m":249.328,"amortisation_m":127.302},{"year":2021,"team":"Arsenal","revenue":324519000.0,"wages":212416000.0,"amortisation":117413000.0,"position_finished":"8th","league":"Premier League","revenue_m":324.519,"wages_m":212.416,"amortisation_m":117.413},{"year":2021,"team":"Wolves","revenue":194096000.0,"wages":123048000.0,"amortisation":62140000.0,"position_finished":"13th","league":"Premier League","revenue_m":194.096,"wages_m":123.048,"amortisation_m":62.14},{"year":2020,"team":"Brighton","revenue":123291000.0,"wages":89314000.0,"amortisation":45616000.0,"position_finished":"15th","league":"Premier League","revenue_m":123.291,"wages_m":89.314,"amortisation_m":45.616},{"year":2021,"team":"Brighton","revenue":139731000.0,"wages":93983000.0,"amortisation":46380000.0,"position_finished":"16th","league":"Premier League","revenue_m":139.731,"wages_m":93.983,"amortisation_m":46.38},{"year":2016,"team":"Newcastle","revenue":125755000.0,"wages":66335000.0,"amortisation":28336000.0,"position_finished":"18th","league":"Premier League","revenue_m":125.755,"wages_m":66.335,"amortisation_m":28.336},{"year":2020,"team":"Wolves","revenue":132609000.0,"wages":83120000.0,"amortisation":51917000.0,"position_finished":"7th","league":"Premier League","revenue_m":132.609,"wages_m":83.12,"amortisation_m":51.917},{"year":2020,"team":"Arsenal","revenue":339968000.0,"wages":204700000.0,"amortisation":109114000.0,"position_finished":"8th","league":"Premier League","revenue_m":339.968,"wages_m":204.7,"amortisation_m":109.114},{"year":2019,"team":"Manchester City","revenue":535169000.0,"wages":276947000.0,"amortisation":126561000.0,"position_finished":"1st","league":"Premier League","revenue_m":535.169,"wages_m":276.947,"amortisation_m":126.561},{"year":2022,"team":"Arsenal","revenue":367099000.0,"wages":185581000.0,"amortisation":124567000.0,"position_finished":"5th","league":"Premier League","revenue_m":367.099,"wages_m":185.581,"amortisation_m":124.567},{"year":2022,"team":"Wolves","revenue":165659000.0,"wages":104534000.0,"amortisation":60901000.0,"position_finished":"10th","league":"Premier League","revenue_m":165.659,"wages_m":104.534,"amortisation_m":60.901},{"year":2018,"team":"Tottenham","revenue":380697000.0,"wages":147606000.0,"amortisation":67960000.0,"position_finished":"3rd","league":"Premier League","revenue_m":380.697,"wages_m":147.606,"amortisation_m":67.96},{"year":2023,"team":"Brighton","revenue":203574000.0,"wages":109446000.0,"amortisation":32763000.0,"position_finished":"6th","league":"Premier League","revenue_m":203.574,"wages_m":109.446,"amortisation_m":32.763},{"year":2022,"team":"Brighton","revenue":167429000.0,"wages":98791000.0,"amortisation":45438000.0,"position_finished":"9th","league":"Premier League","revenue_m":167.429,"wages_m":98.791,"amortisation_m":45.438},{"year":2015,"team":"Newcastle","revenue":128830000.0,"wages":65087000.0,"amortisation":20497000.0,"position_finished":"15th","league":"Premier League","revenue_m":128.83,"wages_m":65.087,"amortisation_m":20.497},{"year":2023,"team":"Wolves","revenue":168575000.0,"wages":123816000.0,"amortisation":79225000.0,"position_finished":"13th","league":"Premier League","revenue_m":168.575,"wages_m":123.816,"amortisation_m":79.225},{"year":2019,"team":"Tottenham","revenue":460695000.0,"wages":178602000.0,"amortisation":46217000.0,"position_finished":"4th","league":"Premier League","revenue_m":460.695,"wages_m":178.602,"amortisation_m":46.217},{"year":2023,"team":"Arsenal","revenue":463100000.0,"wages":204648000.0,"amortisation":139060000.0,"position_finished":"2nd","league":"Premier League","revenue_m":463.1,"wages_m":204.648,"amortisation_m":139.06},{"year":2018,"team":"Manchester City","revenue":500456000.0,"wages":225942000.0,"amortisation":134284000.0,"position_finished":"1st","league":"Premier League","revenue_m":500.456,"wages_m":225.942,"amortisation_m":134.284},{"year":2019,"team":"Leicester","revenue":178429000.0,"wages":122396000.0,"amortisation":63509000.0,"position_finished":"9th","league":"Premier League","revenue_m":178.429,"wages_m":122.396,"amortisation_m":63.509},{"year":2020,"team":"Manchester City","revenue":478359000.0,"wages":307278000.0,"amortisation":145820000.0,"position_finished":"2nd","league":"Premier League","revenue_m":478.359,"wages_m":307.278,"amortisation_m":145.82},{"year":2017,"team":"Crystal Palace","revenue":142735000.0,"wages":98724000.0,"amortisation":32653000.0,"position_finished":"14th","league":"Premier League","revenue_m":142.735,"wages_m":98.724,"amortisation_m":32.653},{"year":2016,"team":"Crystal Palace","revenue":101816000.0,"wages":71044000.0,"amortisation":18141000.0,"position_finished":"15th","league":"Premier League","revenue_m":101.816,"wages_m":71.044,"amortisation_m":18.141},{"year":2020,"team":"Tottenham","revenue":391862000.0,"wages":181280000.0,"amortisation":73675000.0,"position_finished":"6th","league":"Premier League","revenue_m":391.862,"wages_m":181.28,"amortisation_m":73.675},{"year":2021,"team":"Manchester City","revenue":569849000.0,"wages":310737000.0,"amortisation":145697000.0,"position_finished":"1st","league":"Premier League","revenue_m":569.849,"wages_m":310.737,"amortisation_m":145.697},{"year":2020,"team":"Leicester","revenue":149950000.0,"wages":128239000.0,"amortisation":77787000.0,"position_finished":"5th","league":"Premier League","revenue_m":149.95,"wages_m":128.239,"amortisation_m":77.787},{"year":2023,"team":"Manchester City","revenue":712768000.0,"wages":368213000.0,"amortisation":145448000.0,"position_finished":"1st","league":"Premier League","revenue_m":712.768,"wages_m":368.213,"amortisation_m":145.448},{"year":2018,"team":"Arsenal","revenue":385920000.0,"wages":210141000.0,"amortisation":85812000.0,"position_finished":"6th","league":"Premier League","revenue_m":385.92,"wages_m":210.141,"amortisation_m":85.812},{"year":2019,"team":"Brighton","revenue":143132000.0,"wages":88286000.0,"amortisation":33238000.0,"position_finished":"17th","league":"Premier League","revenue_m":143.132,"wages_m":88.286,"amortisation_m":33.238},{"year":2018,"team":"Brighton","revenue":139155000.0,"wages":67793000.0,"amortisation":19311000.0,"position_finished":"15th","league":"Premier League","revenue_m":139.155,"wages_m":67.793,"amortisation_m":19.311},{"year":2015,"team":"Crystal Palace","revenue":102395970.0,"wages":60154251.0,"amortisation":10715180.0,"position_finished":"10th","league":"Premier League","revenue_m":102.39597,"wages_m":60.154251,"amortisation_m":10.71518},{"year":2019,"team":"Wolves","revenue":172464000.0,"wages":80842000.0,"amortisation":37724000.0,"position_finished":"7th","league":"Premier League","revenue_m":172.464,"wages_m":80.842,"amortisation_m":37.724},{"year":2019,"team":"Arsenal","revenue":390148000.0,"wages":205210000.0,"amortisation":89678000.0,"position_finished":"5th","league":"Premier League","revenue_m":390.148,"wages_m":205.21,"amortisation_m":89.678},{"year":2022,"team":"Manchester City","revenue":613014000.0,"wages":308675000.0,"amortisation":140708000.0,"position_finished":"1st","league":"Premier League","revenue_m":613.014,"wages_m":308.675,"amortisation_m":140.708},{"year":2022,"team":"Newcastle","revenue":179986000.0,"wages":149225000.0,"amortisation":51139000.0,"position_finished":"11th","league":"Premier League","revenue_m":179.986,"wages_m":149.225,"amortisation_m":51.139},{"year":2018,"team":"Crystal Palace","revenue":150346000.0,"wages":103243000.0,"amortisation":46034000.0,"position_finished":"11th","league":"Premier League","revenue_m":150.346,"wages_m":103.243,"amortisation_m":46.034},{"year":2019,"team":"Crystal Palace","revenue":155404000.0,"wages":104878000.0,"amortisation":49852000.0,"position_finished":"12th","league":"Premier League","revenue_m":155.404,"wages_m":104.878,"amortisation_m":49.852},{"year":2023,"team":"Newcastle","revenue":250265000.0,"wages":164800000.0,"amortisation":86811000.0,"position_finished":"4th","league":"Premier League","revenue_m":250.265,"wages_m":164.8,"amortisation_m":86.811},{"year":2015,"team":"Arsenal","revenue":328532000.0,"wages":192213000.0,"amortisation":54430000.0,"position_finished":"3rd","league":"Premier League","revenue_m":328.532,"wages_m":192.213,"amortisation_m":54.43},{"year":2018,"team":"Leicester","revenue":158881000.0,"wages":97452000.0,"amortisation":48419000.0,"position_finished":"9th","league":"Premier League","revenue_m":158.881,"wages_m":97.452,"amortisation_m":48.419},{"year":2021,"team":"Leicester","revenue":226204000.0,"wages":158794000.0,"amortisation":71953000.0,"position_finished":"5th","league":"Premier League","revenue_m":226.204,"wages_m":158.794,"amortisation_m":71.953},{"year":2021,"team":"Tottenham","revenue":361872000.0,"wages":179789000.0,"amortisation":73812000.0,"position_finished":"7th","league":"Premier League","revenue_m":361.872,"wages_m":179.789,"amortisation_m":73.812},{"year":2022,"team":"Leicester","revenue":214590000.0,"wages":148403000.0,"amortisation":72325000.0,"position_finished":"8th","league":"Premier League","revenue_m":214.59,"wages_m":148.403,"amortisation_m":72.325},{"year":2022,"team":"Tottenham","revenue":444028000.0,"wages":181819000.0,"amortisation":79520000.0,"position_finished":"4th","league":"Premier League","revenue_m":444.028,"wages_m":181.819,"amortisation_m":79.52},{"year":2023,"team":"Tottenham","revenue":549633000.0,"wages":218897000.0,"amortisation":109073000.0,"position_finished":"8th","league":"Premier League","revenue_m":549.633,"wages_m":218.897,"amortisation_m":109.073},{"year":2017,"team":"Arsenal","revenue":415867000.0,"wages":199395000.0,"amortisation":77126000.0,"position_finished":"5th","league":"Premier League","revenue_m":415.867,"wages_m":199.395,"amortisation_m":77.126},{"year":2021,"team":"Newcastle","revenue":140192000.0,"wages":93951000.0,"amortisation":32277000.0,"position_finished":"12th","league":"Premier League","revenue_m":140.192,"wages_m":93.951,"amortisation_m":32.277},{"year":2020,"team":"Newcastle","revenue":152626000.0,"wages":106878000.0,"amortisation":58696000.0,"position_finished":"13th","league":"Premier League","revenue_m":152.626,"wages_m":106.878,"amortisation_m":58.696},{"year":2016,"team":"Arsenal","revenue":347393000.0,"wages":195387000.0,"amortisation":59257000.0,"position_finished":"2nd","league":"Premier League","revenue_m":347.393,"wages_m":195.387,"amortisation_m":59.257},{"year":2023,"team":"Nottingham Forest","revenue":154758000.0,"wages":129718000.0,"amortisation":40766000.0,"position_finished":"16th","league":"Premier League","revenue_m":154.758,"wages_m":129.718,"amortisation_m":40.766},{"year":2015,"team":"Manchester City","revenue":351766000.0,"wages":168718000.0,"amortisation":70291000.0,"position_finished":"2nd","league":"Premier League","revenue_m":351.766,"wages_m":168.718,"amortisation_m":70.291},{"year":2018,"team":"Newcastle","revenue":178495000.0,"wages":82557000.0,"amortisation":41336000.0,"position_finished":"10th","league":"Premier League","revenue_m":178.495,"wages_m":82.557,"amortisation_m":41.336},{"year":2022,"team":"Crystal Palace","revenue":159999000.0,"wages":101034000.0,"amortisation":34151000.0,"position_finished":"12th","league":"Premier League","revenue_m":159.999,"wages_m":101.034,"amortisation_m":34.151},{"year":2023,"team":"Crystal Palace","revenue":180066000.0,"wages":114191000.0,"amortisation":40487000.0,"position_finished":"11th","league":"Premier League","revenue_m":180.066,"wages_m":114.191,"amortisation_m":40.487},{"year":2019,"team":"Newcastle","revenue":176448000.0,"wages":96798000.0,"amortisation":38611000.0,"position_finished":"13th","league":"Premier League","revenue_m":176.448,"wages_m":96.798,"amortisation_m":38.611},{"year":2015,"team":"Tottenham","revenue":196377000.0,"wages":89752000.0,"amortisation":37202000.0,"position_finished":"5th","league":"Premier League","revenue_m":196.377,"wages_m":89.752,"amortisation_m":37.202},{"year":2015,"team":"Leicester","revenue":104437000.0,"wages":57438000.0,"amortisation":7337000.0,"position_finished":"14th","league":"Premier League","revenue_m":104.437,"wages_m":57.438,"amortisation_m":7.337},{"year":2017,"team":"Leicester","revenue":233013000.0,"wages":112555000.0,"amortisation":29701000.0,"position_finished":"12th","league":"Premier League","revenue_m":233.013,"wages_m":112.555,"amortisation_m":29.701},{"year":2016,"team":"Manchester City","revenue":391774000.0,"wages":174360000.0,"amortisation":93952000.0,"position_finished":"4th","league":"Premier League","revenue_m":391.774,"wages_m":174.36,"amortisation_m":93.952},{"year":2017,"team":"Tottenham","revenue":306321000.0,"wages":111817000.0,"amortisation":42905000.0,"position_finished":"2nd","league":"Premier League","revenue_m":306.321,"wages_m":111.817,"amortisation_m":42.905},{"year":2021,"team":"Crystal Palace","revenue":134383000.0,"wages":111375000.0,"amortisation":36454000.0,"position_finished":"14th","league":"Premier League","revenue_m":134.383,"wages_m":111.375,"amortisation_m":36.454},{"year":2020,"team":"Crystal Palace","revenue":142347000.0,"wages":115990000.0,"amortisation":43386000.0,"position_finished":"14th","league":"Premier League","revenue_m":142.347,"wages_m":115.99,"amortisation_m":43.386},{"year":2016,"team":"Tottenham","revenue":209770000.0,"wages":100042000.0,"amortisation":31785000.0,"position_finished":"3rd","league":"Premier League","revenue_m":209.77,"wages_m":100.042,"amortisation_m":31.785},{"year":2017,"team":"Manchester City","revenue":473375000.0,"wages":232840000.0,"amortisation":121742000.0,"position_finished":"3rd","league":"Premier League","revenue_m":473.375,"wages_m":232.84,"amortisation_m":121.742},{"year":2016,"team":"Leicester","revenue":128715000.0,"wages":68772000.0,"amortisation":15804000.0,"position_finished":"1st","league":"Premier League","revenue_m":128.715,"wages_m":68.772,"amortisation_m":15.804},{"year":2017,"team":"West Ham","revenue":183340000.0,"wages":83468000.0,"amortisation":45394000.0,"position_finished":"11th","league":"Premier League","revenue_m":183.34,"wages_m":83.468,"amortisation_m":45.394},{"year":2022,"team":"Southampton","revenue":150628000.0,"wages":98872000.0,"amortisation":35134000.0,"position_finished":"15th","league":"Premier League","revenue_m":150.628,"wages_m":98.872,"amortisation_m":35.134},{"year":2020,"team":"Bournemouth","revenue":95380000.0,"wages":95021000.0,"amortisation":47170000.0,"position_finished":"18th","league":"Premier League","revenue_m":95.38,"wages_m":95.021,"amortisation_m":47.17},{"year":2023,"team":"Southampton","revenue":145539000.0,"wages":89400000.0,"amortisation":52000000.0,"position_finished":"20th","league":"Premier League","revenue_m":145.539,"wages_m":89.4,"amortisation_m":52.0},{"year":2016,"team":"West Ham","revenue":142063000.0,"wages":74828000.0,"amortisation":34416000.0,"position_finished":"7th","league":"Premier League","revenue_m":142.063,"wages_m":74.828,"amortisation_m":34.416},{"year":2018,"team":"Everton","revenue":188836000.0,"wages":100707000.0,"amortisation":66929000.0,"position_finished":"8th","league":"Premier League","revenue_m":188.836,"wages_m":100.707,"amortisation_m":66.929},{"year":2018,"team":"Manchester United","revenue":571577000.0,"wages":255181000.0,"amortisation":136993000.0,"position_finished":"2nd","league":"Premier League","revenue_m":571.577,"wages_m":255.181,"amortisation_m":136.993},{"year":2021,"team":"Southampton","revenue":157245000.0,"wages":99158000.0,"amortisation":47350000.0,"position_finished":"15th","league":"Premier League","revenue_m":157.245,"wages_m":99.158,"amortisation_m":47.35},{"year":2019,"team":"Manchester United","revenue":601935000.0,"wages":324004000.0,"amortisation":125532000.0,"position_finished":"6th","league":"Premier League","revenue_m":601.935,"wages_m":324.004,"amortisation_m":125.532},{"year":2015,"team":"West Ham","revenue":120747000.0,"wages":72715000.0,"amortisation":21592000.0,"position_finished":"12th","league":"Premier League","revenue_m":120.747,"wages_m":72.715,"amortisation_m":21.592},{"year":2023,"team":"Bournemouth","revenue":140983000.0,"wages":87832000.0,"amortisation":41226000.0,"position_finished":"15th","league":"Premier League","revenue_m":140.983,"wages_m":87.832,"amortisation_m":41.226},{"year":2020,"team":"Southampton","revenue":126636000.0,"wages":100107000.0,"amortisation":56674000.0,"position_finished":"11th","league":"Premier League","revenue_m":126.636,"wages_m":100.107,"amortisation_m":56.674},{"year":2019,"team":"Everton","revenue":187664000.0,"wages":140468000.0,"amortisation":95057000.0,"position_finished":"8th","league":"Premier League","revenue_m":187.664,"wages_m":140.468,"amortisation_m":95.057},{"year":2017,"team":"Chelsea","revenue":361308000.0,"wages":195290000.0,"amortisation":89642000.0,"position_finished":"1st","league":"Premier League","revenue_m":361.308,"wages_m":195.29,"amortisation_m":89.642},{"year":2021,"team":"Everton","revenue":193143000.0,"wages":159221000.0,"amortisation":81243000.0,"position_finished":"10th","league":"Premier League","revenue_m":193.143,"wages_m":159.221,"amortisation_m":81.243},{"year":2022,"team":"Aston Villa","revenue":178399000.0,"wages":119037000.0,"amortisation":82535000.0,"position_finished":"14th","league":"Premier League","revenue_m":178.399,"wages_m":119.037,"amortisation_m":82.535},{"year":2021,"team":"Manchester United","revenue":464839000.0,"wages":276752000.0,"amortisation":120206000.0,"position_finished":"2nd","league":"Premier League","revenue_m":464.839,"wages_m":276.752,"amortisation_m":120.206},{"year":2018,"team":"Southampton","revenue":152623000.0,"wages":99557000.0,"amortisation":36706000.0,"position_finished":"17th","league":"Premier League","revenue_m":152.623,"wages_m":99.557,"amortisation_m":36.706},{"year":2016,"team":"Liverpool","revenue":301765000.0,"wages":184829000.0,"amortisation":64537000.0,"position_finished":"8th","league":"Premier League","revenue_m":301.765,"wages_m":184.829,"amortisation_m":64.537},{"year":2017,"team":"Liverpool","revenue":364246000.0,"wages":184300000.0,"amortisation":58352000.0,"position_finished":"4th","league":"Premier League","revenue_m":364.246,"wages_m":184.3,"amortisation_m":58.352},{"year":2019,"team":"Southampton","revenue":149627000.0,"wages":100474000.0,"amortisation":53304000.0,"position_finished":"16th","league":"Premier League","revenue_m":149.627,"wages_m":100.474,"amortisation_m":53.304},{"year":2020,"team":"Manchester United","revenue":487460000.0,"wages":242557000.0,"amortisation":122696000.0,"position_finished":"3rd","league":"Premier League","revenue_m":487.46,"wages_m":242.557,"amortisation_m":122.696},{"year":2023,"team":"Aston Villa","revenue":217694000.0,"wages":168892000.0,"amortisation":92519000.0,"position_finished":"7th","league":"Premier League","revenue_m":217.694,"wages_m":168.892,"amortisation_m":92.519},{"year":2020,"team":"Everton","revenue":185882000.0,"wages":144202000.0,"amortisation":99232000.0,"position_finished":"12th","league":"Premier League","revenue_m":185.882,"wages_m":144.202,"amortisation_m":99.232},{"year":2016,"team":"Chelsea","revenue":329122000.0,"wages":195846000.0,"amortisation":70877000.0,"position_finished":"10th","league":"Premier League","revenue_m":329.122,"wages_m":195.846,"amortisation_m":70.877},{"year":2022,"team":"Everton","revenue":181007000.0,"wages":141390000.0,"amortisation":68327000.0,"position_finished":"16th","league":"Premier League","revenue_m":181.007,"wages_m":141.39,"amortisation_m":68.327},{"year":2021,"team":"Aston Villa","revenue":183632000.0,"wages":121936000.0,"amortisation":56125000.0,"position_finished":"11th","league":"Premier League","revenue_m":183.632,"wages_m":121.936,"amortisation_m":56.125},{"year":2022,"team":"Manchester United","revenue":539937000.0,"wages":329694000.0,"amortisation":148838000.0,"position_finished":"6th","league":"Premier League","revenue_m":539.937,"wages_m":329.694,"amortisation_m":148.838},{"year":2018,"team":"Bournemouth","revenue":134861000.0,"wages":88608000.0,"amortisation":26750000.0,"position_finished":"12th","league":"Premier League","revenue_m":134.861,"wages_m":88.608,"amortisation_m":26.75},{"year":2015,"team":"Liverpool","revenue":297947000.0,"wages":145654000.0,"amortisation":60980000.0,"position_finished":"6th","league":"Premier League","revenue_m":297.947,"wages_m":145.654,"amortisation_m":60.98},{"year":2019,"team":"Bournemouth","revenue":131134000.0,"wages":97412000.0,"amortisation":36195000.0,"position_finished":"14th","league":"Premier League","revenue_m":131.134,"wages_m":97.412,"amortisation_m":36.195},{"year":2023,"team":"Manchester United","revenue":601313000.0,"wages":276596000.0,"amortisation":169531000.0,"position_finished":"3rd","league":"Premier League","revenue_m":601.313,"wages_m":276.596,"amortisation_m":169.531},{"year":2020,"team":"Aston Villa","revenue":112596000.0,"wages":95121000.0,"amortisation":70599000.0,"position_finished":"17th","league":"Premier League","revenue_m":112.596,"wages_m":95.121,"amortisation_m":70.599},{"year":2023,"team":"Everton","revenue":172155000.0,"wages":138394000.0,"amortisation":77621000.0,"position_finished":"17th","league":"Premier League","revenue_m":172.155,"wages_m":138.394,"amortisation_m":77.621},{"year":2015,"team":"Chelsea","revenue":314287000.0,"wages":215647000.0,"amortisation":69363000.0,"position_finished":"1st","league":"Premier League","revenue_m":314.287,"wages_m":215.647,"amortisation_m":69.363},{"year":2023,"team":"Leicester","revenue":177326000.0,"wages":171950000.0,"amortisation":76945000.0,"position_finished":"18th","league":"Premier League","revenue_m":177.326,"wages_m":171.95,"amortisation_m":76.945}];

    // Populate the year dropdown with unique years in descending order (latest first)
    var years = [...new Set(data.map(item => item.year))].sort(function(a, b) { return b - a; });
    var yearSelect = document.getElementById('yearSelect');
    years.forEach(function(year) {
      var option = document.createElement('option');
      option.value = year;
      option.text = year;
      yearSelect.appendChild(option);
    });
    // Set default value to the latest year
    yearSelect.value = years[0];

    // Function to update the bar chart with smooth animation
    function updateChart() {
      var selectedYear = parseInt(document.getElementById('yearSelect').value);
      var selectedMetric = document.getElementById('metricSelect').value;

      // Filter data for the selected year
      var filtered = data.filter(item => item.year === selectedYear);
      // Sort data descending by the selected metric
      filtered.sort(function(a, b) {
        return b[selectedMetric] - a[selectedMetric];
      });

      // Prepare arrays for team names.
      var teams = filtered.map(item => item.team);
      
      // For revenue, wages, and amortisation use the _m values.
      var values;
      if(selectedMetric === "revenue") {
        values = filtered.map(item => item.revenue_m);
      } else if(selectedMetric === "wages") {
        values = filtered.map(item => item.wages_m);
      } else if(selectedMetric === "amortisation") {
        values = filtered.map(item => item.amortisation_m);
      } else {
        values = filtered.map(item => item[selectedMetric]);
      }

      // Prepare an array for finish info (e.g., "14th")
      var finishInfo = filtered.map(item => item.position_finished);

      // Compute maximum value and set y-axis maximum (with 10% margin)
      var maxVal = Math.max.apply(null, values);
      var yMax = maxVal * 1.1;

      // Create the main bar trace.
      var trace = {
        x: teams,
        y: values,
        type: 'bar',
        marker: { color: '#05D4BE' },
        customdata: finishInfo,
        // Hover shows: "League Position - <b>14th</b>" on the top line and then "£351.7m" on the next line.
        hovertemplate: "League Position - <b>%{customdata}</b><br>£%{y:.1f}m<extra></extra>"
      };

      // Define layout with y-axis starting at 0 and unified hover mode.
      var layout = {
        title: selectedMetric.charAt(0).toUpperCase() + selectedMetric.slice(1) +
               ' for Premier League Clubs in ' + selectedYear,
        xaxis: {
          title: 'Club',
          tickangle: -45,
          showgrid: false,
          showline: true,
          linecolor: 'white',
          linewidth: 2
        },
        yaxis: {
          title: selectedMetric.charAt(0).toUpperCase() + selectedMetric.slice(1) + ' (in millions)',
          showgrid: true,
          gridcolor: 'rgba(128,128,128,0.2)',
          showline: true,
          linecolor: 'white',
          linewidth: 2,
          range: [0, yMax]
        },
        plot_bgcolor: '#11242B',
        paper_bgcolor: '#11242B',
        font: {
          family: 'aglet-sans, sans-serif',
          size: 12,
          color: 'white'
        },
        margin: { l: 60, r: 40, t: 60, b: 100 },
        hovermode: 'x unified'
      };

      Plotly.react('barChart', [trace], layout, {
        transition: { duration: 1000, easing: 'cubic-in-out' },
        frame: { duration: 1000 }
      });
    }

    document.getElementById('yearSelect').addEventListener('change', updateChart);
    document.getElementById('metricSelect').addEventListener('change', updateChart);

    updateChart();

    document.addEventListener("DOMContentLoaded", function(){
        setTimeout(function(){
            var texts = document.querySelectorAll('svg text');
            for(var i = 0; i < texts.length; i++) {
                texts[i].setAttribute("font-family", "aglet-sans, sans-serif");
            }
        }, 500);
    });
  </script>
</body>
</html>
