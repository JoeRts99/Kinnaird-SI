
<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>Player Amortisation Graph</title>
    <!-- Load Aglet Sans from Typekit -->
    <link href="https://use.typekit.net/xxs6huv.css" rel="stylesheet">
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
      body {
          font-family: 'aglet-sans', sans-serif !important;
          background-color: #11242B;
          margin: 0;
          padding: 0;
      }
      .toggle-container {
          text-align: center;
          margin-bottom: 20px;
          color: white;
          font-size: 14px;
          padding-top: 20px;
      }
      .toggle-container input {
          margin-right: 6px;
      }
      svg text {
          font-family: 'aglet-sans', sans-serif !important;
          fill: white;
      }
      .axis-x path, .axis-y path {
          stroke: rgba(255, 255, 255, 0.3);
      }
      .axis-x .tick line, .axis-y .tick line {
          stroke: rgba(128, 128, 128, 0.2);
      }
      .axis-x text, .axis-y text {
          fill: white;
          font-size: 12px;
      }
      .tooltip {
          position: absolute;
          padding: 10px;
          background: #1D3B48;
          color: white;
          border: 1px solid #05D4BE;
          border-radius: 5px;
          pointer-events: none;
          font-family: 'aglet-sans', sans-serif;
          font-size: 14px;
          opacity: 0;
          transition: opacity 0.3s;
          z-index: 10;
      }
      .area {
          fill: rgba(5, 212, 190, 0.2);
      }
      .line {
          fill: none;
          stroke: #05D4BE;
          stroke-width: 2;
      }
    </style>
</head>
<body>
    <div class="toggle-container">
      <label>
         <input type="checkbox" id="inflationCheckbox"> Adjust for Inflation
      </label>
    </div>
    <div id="chart" style="width: 100%; height: 550px;"></div>
    <div id="tooltip" class="tooltip"></div>
    
    <script>
      // Data for the chart
      const financialYears = [2015, 2016, 2017, 2018, 2019, 2020, 2021, 2022, 2023];
      const absolutePlayerAmortisation = [5064000.0, 10246000.0, 22350000.0, 27754000.0, 37516000.0, 32315000.0, 21411000.0, 22703000.0, 22115000.0];
      const adjustedPlayerAmortisation = [7596000.0, 14856700.0, 31289999.999999996, 37467900.0, 48770800.0, 40393750.0, 25693200.0, 26108449.999999996, 24326500.000000004];
      const positionData = [null, null, null, null, null, null, null, null, null];
      const leagueData = [null, null, null, null, null, null, null, null, null];
      
      // Chart rendering function
      function renderChart(amortisationData) {
          // Clear previous chart if any
          d3.select("#chart").html("");
          
          // Set up dimensions
          const margin = {top: 40, right: 40, bottom: 60, left: 60};
          const width = document.getElementById('chart').clientWidth - margin.left - margin.right;
          const height = document.getElementById('chart').clientHeight - margin.top - margin.bottom;
          
          // Create SVG container
          const svg = d3.select("#chart")
              .append("svg")
              .attr("width", width + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
              .append("g")
              .attr("transform", `translate(${margin.left}, ${margin.top})`);
          
          // Set up scales
          const x = d3.scaleLinear()
              .domain([d3.min(financialYears), d3.max(financialYears) + 0.5])
              .range([0, width]);
          
          const y = d3.scaleLinear()
              .domain([0, d3.max(amortisationData) * 1.1])
              .range([height, 0]);
          
          // Create a line generator
          const line = d3.line()
              .x((d, i) => x(financialYears[i]))
              .y(d => y(d))
              .curve(d3.curveMonotoneX);
          
          // Create area generator for the fill
          const area = d3.area()
              .x((d, i) => x(financialYears[i]))
              .y0(height)
              .y1(d => y(d))
              .curve(d3.curveMonotoneX);
          
          // Add X axis
          svg.append("g")
              .attr("class", "axis-x")
              .attr("transform", `translate(0, ${height})`)
              .call(d3.axisBottom(x)
                  .tickFormat(d3.format("d"))
                  .ticks(financialYears.length)
                  .tickValues(financialYears));
          
          // Add Y axis
          svg.append("g")
              .attr("class", "axis-y")
              .call(d3.axisLeft(y)
                  .tickFormat(d => `£${(d/1000000).toFixed(0)}M`));
          
          // Add the area
          svg.append("path")
              .datum(amortisationData)
              .attr("class", "area")
              .attr("d", area);
          
          // Add the line
          svg.append("path")
              .datum(amortisationData)
              .attr("class", "line")
              .attr("d", line);
          
          // Add data points with tooltips
          svg.selectAll(".dot")
              .data(amortisationData)
              .enter()
              .append("circle")
              .attr("class", "dot")
              .attr("cx", (d, i) => x(financialYears[i]))
              .attr("cy", d => y(d))
              .attr("r", 5)
              .attr("fill", "#05D4BE")
              .attr("stroke", "white")
              .attr("stroke-width", 1)
              .on("mouseover", function(event, d, i) {
                  const index = amortisationData.indexOf(d);
                  const year = financialYears[index];
                  const position = positionData[index];
                  const league = leagueData[index];
                  
                  // Highlight dot
                  d3.select(this)
                      .attr("r", 7)
                      .attr("stroke-width", 2);
                  
                  // Show tooltip
                  d3.select("#tooltip")
                      .style("opacity", 1)
                      .style("left", (event.pageX + 10) + "px")
                      .style("top", (event.pageY - 15) + "px")
                      .html(`
                          <b>${position} in ${league}</b><br>
                          Financial Year: ${year}<br>
                          Player Amortisation: £${(d/1000000).toFixed(1)}M
                      `);
              })
              .on("mouseout", function() {
                  // Reset dot size
                  d3.select(this)
                      .attr("r", 5)
                      .attr("stroke-width", 1);
                  
                  // Hide tooltip
                  d3.select("#tooltip")
                      .style("opacity", 0);
              });
          
          // Add axis labels
          svg.append("text")
              .attr("class", "axis-title")
              .attr("x", width / 2)
              .attr("y", height + margin.bottom - 10)
              .attr("text-anchor", "middle")
              .style("fill", "white")
              .text("Financial Year");
          
          svg.append("text")
              .attr("class", "axis-title")
              .attr("transform", "rotate(-90)")
              .attr("x", -height / 2)
              .attr("y", -margin.left + 15)
              .attr("text-anchor", "middle")
              .style("fill", "white")
              .text("Player Amortisation (GBP)");
      }
      
      // Initial render with absolute data
      renderChart(absolutePlayerAmortisation);
      
      // Add event listener to toggle inflation adjustment
      document.getElementById("inflationCheckbox").addEventListener("change", function() {
          if (this.checked) {
              renderChart(adjustedPlayerAmortisation);
          } else {
              renderChart(absolutePlayerAmortisation);
          }
      });
    </script>
</body>
</html>
